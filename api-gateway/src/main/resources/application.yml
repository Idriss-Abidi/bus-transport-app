server:
  port: 4004 # Gateway listens on port 4004

spring:
  cloud:
    gateway:
      routes:
        # Route for /api/trajets/** to trajet-service
        - id: trajet-service-route
          # When running in Docker, the gateway container can reach the trajet
          # container by its service name (container name) on the same Docker network.
          # Use http://trajet-service:4000 for container-to-container communication.
          uri: http://trajet-service:4000
          predicates:
            - Path=/api/trajets/**
          filters:
            - StripPrefix=1

        # Route for /api/stations/** to trajet-service
        - id: station-service-route
          uri: http://trajet-service:4000
          predicates:
            - Path=/api/stations/**
          filters:
            - StripPrefix=1

        # Route for /api/trajet-times/** to trajet-service
        - id: trajet-times-route
          uri: http://trajet-service:4000
          predicates:
            - Path=/api/trajet-times/**
          filters:
            - StripPrefix=1

        # Route for /api/trajet-stations/** to trajet-service
        - id: trajet-stations-route
          uri: http://trajet-service:4000
          predicates:
            - Path=/api/trajet-stations/**
          filters:
            - StripPrefix=1

        # Route for /api/trajet-cities/** to trajet-service
        - id: trajet-cities-route
          uri: http://trajet-service:4000
          predicates:
            - Path=/api/trajet-cities/**
          filters:
            - StripPrefix=1

        # Route for /api/docs/trajets -> /v3/api-docs on trajet-service
        - id: api-docs-trajet-route
          uri: http://trajet-service:4000
          predicates:
            - Path=/api-docs/trajets
          filters:
            - RewritePath=/api-docs/trajets,/v3/api-docs

        # Route for /api/tickets/** to ticket-service
        - id: ticket-service-route
          uri: http://ticket-service:4003
          predicates:

            - Path=/api/tickets/**
          filters:
            - StripPrefix=1

        # Route for /api/docs/tickets -> /v3/api-docs on ticket-service
        - id: api-docs-ticket-route
          uri: http://ticket-service:4003
          predicates:
            - Path=/api-docs/tickets
          filters:
            - RewritePath=/api-docs/tickets,/v3/api-docs

        # Route for /api/users/** to user-service
        - id: user-service-route
          uri: http://user-service:4005
          predicates:
            - Path=/api/users,/api/users/**
          filters:
            - StripPrefix=1

        # Route for /api/docs/users -> /v3/api-docs on user-service
        - id: api-docs-user-route
          uri: http://user-service:4005
          predicates:
            - Path=/api-docs/users
          filters:
            - RewritePath=/api-docs/users,/v3/api-docs

        # Route for /api/notifications/** to notification-service
        - id: notification-service-route
          uri: http://notification-service:4010
          predicates:
            - Path=/api/notifications,/api/notifications/**
          filters:
            - StripPrefix=1

        # Route for /api/docs/notifications -> /v3/api-docs on notification-service
        - id: api-docs-notification-route
          uri: http://notification-service:4010
          predicates:
            - Path=/api-docs/notifications
          filters:
            - RewritePath=/api-docs/notifications,/v3/api-docs
